(window.webpackJsonp=window.webpackJsonp||[]).push([[103],{625:function(t,e,r){"use strict";r.r(e);var a=r(5),s=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"github-大文件提交"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#github-大文件提交"}},[t._v("#")]),t._v(" GITHUB 大文件提交")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("下载安装 Git Large File Storage 命令行工具。参考"),e("a",{attrs:{href:"https://docs.github.com/en/repositories/working-with-files/managing-large-files/installing-git-large-file-storage",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),e("OutboundLink")],1),t._v("。 "),e("code",[t._v("brew install git-lfs")])])]),t._v(" "),e("li",[e("p",[t._v("配置 Git LFS。每个用户只需要配置一次就好了 "),e("code",[t._v("git lfs install")])])]),t._v(" "),e("li",[e("p",[t._v("在想要使用大文件追踪的 GIT 目录下，使用如下命令追踪大文件。 "),e("code",[t._v('git lfs track "*.psd"')]),t._v("。")])]),t._v(" "),e("li",[e("p",[t._v("就像正常提交文件一样提交就好了。")]),t._v(" "),e("div",{staticClass:"language-swift extra-class"},[e("pre",{pre:!0,attrs:{class:"language-swift"}},[e("code",[t._v("git add file"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("psd\ngit commit "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("m "),e("span",{pre:!0,attrs:{class:"token string-literal"}},[e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Add design file"')])]),t._v("\ngit push origin main\n")])])])])]),t._v(" "),e("blockquote",[e("p",[t._v("Note")]),t._v(" "),e("ol",[e("li",[t._v("对于新增加的大文件可以使用这种方式，对于已经存在的大文件使用 "),e("code",[t._v("git lfs migrate")]),t._v(" 命令。")]),t._v(" "),e("li",[t._v("通过命令 "),e("code",[t._v("git add .gitattributes")]),t._v(" 来增加属性文件，确保大文件被追踪。")])])]),t._v(" "),e("h2",{attrs:{id:"github-大文件清理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#github-大文件清理"}},[t._v("#")]),t._v(" GITHUB 大文件清理")]),t._v(" "),e("p",[t._v("因为 GITHUB 的免费账户有大文件的容量限制，只能上传最多 1G，再多就需要付费了（不付费的的话似乎仓库会被锁定），所以有的时候需要删除 GITHUB 上的大文件，怎么删除呢？")]),t._v(" "),e("p",[t._v("GITHUB 官方并没有提供单独删除大文件的方案，官方文档提示需要将整个仓库移除才行。")]),t._v(" "),e("p",[t._v("我的想法是移除仓库，然后在本地移除指定大文件后，新建仓库重新上传。能不能做到呢？答案是能。")]),t._v(" "),e("p",[t._v("主要是使用 "),e("a",{attrs:{href:"https://rtyley.github.io/bfg-repo-cleaner/",target:"_blank",rel:"noopener noreferrer"}},[t._v("BFG Repo-Cleaner"),e("OutboundLink")],1),t._v(" 这个工具，下载下来 .jar 文件后，在当前的仓库下执行如下命令来清除 100M 以上的文件。")]),t._v(" "),e("div",{staticClass:"language-swift extra-class"},[e("pre",{pre:!0,attrs:{class:"language-swift"}},[e("code",[t._v("$ java "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("jar bfg"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jar "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("strip"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("blobs"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("bigger"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("than 100M "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("some")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("big"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("repo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("git\n")])])]),e("p",[t._v("这个改动会修改所有commit的值，所以涉及到团队协作的话，需要和团队里的其他成员同步你的修改状况，保证所有人用最新的提交。")]),t._v(" "),e("p",[t._v("有的时候执行这个命令没有过滤出git中的大文件，提示 "),e("code",[t._v("no large blobs matching criteria found in packfiles - does the repo need to be packed?")]),t._v("。这时候可以尝试先执行 "),e("code",[t._v("git gc")]),t._v(" 命令重新 pack 一下仓库(参考这个 "),e("a",{attrs:{href:"https://github.com/rtyley/bfg-repo-cleaner/issues/65",target:"_blank",rel:"noopener noreferrer"}},[t._v("issue"),e("OutboundLink")],1),t._v(")，再去移除大文件。")]),t._v(" "),e("p",[t._v("还有一种场景是，大文件是在过去的某个版本中提交的，但是当前的版本已经不再需要这个大文件了，GIT 依然会上传这个大文件，如果不在意历史提交记录的化，可以将历史提交记录重置。")]),t._v(" "),e("p",[t._v("关于删掉提交记录，有人说可以直接删掉 .git 目录，但是似乎是有问题。更好的解决方案可以参考"),e("a",{attrs:{href:"https://stackoverflow.com/questions/13716658/how-to-delete-all-commit-history-in-github",target:"_blank",rel:"noopener noreferrer"}},[t._v("这个问题"),e("OutboundLink")],1),t._v("的回答，主要命令是创建一个孤儿分支 "),e("code",[t._v("git checkout --orphan latest_branch")]),t._v("。")]),t._v(" "),e("p",[t._v("参考地址:")]),t._v(" "),e("ol",[e("li",[e("a",{attrs:{href:"https://git-lfs.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://git-lfs.com/"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://docs.github.com/en/repositories/working-with-files/managing-large-files/removing-files-from-git-large-file-storage",target:"_blank",rel:"noopener noreferrer"}},[t._v("Removing files from Git Large File Storage"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/85555845",target:"_blank",rel:"noopener noreferrer"}},[t._v("Github上使用LFS超限后被禁用的问题"),e("OutboundLink")],1)])])])}),[],!1,null,null,null);e.default=s.exports}}]);