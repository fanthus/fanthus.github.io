(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{369:function(t,a,s){t.exports=s.p+"assets/img/coredata_stack.b248baa4.png"},611:function(t,a,s){"use strict";s.r(a);var e=s(5),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("è¿™ç¯‡ç¬”è®°ä¸»è¦æ˜¯ä»‹ç»ä¸€äº› CoreData çš„åŸºæœ¬æ¦‚å¿µã€‚Core Data æ˜¯è‹¹æœæä¾›çš„æ•°æ®æŒä¹…åŒ–æ–¹æ¡ˆã€‚ç›¸å¯¹äº Sqliteï¼ŒCoreData æä¾›äº†åŸç”Ÿçš„ ORM çš„æ”¯æŒï¼Œä»¥åŠå¯ä»¥å’Œè‹¹æœçš„ Cloud æœåŠ¡è¿›è¡Œé€šä¿¡ï¼Œå¯¹äºç‹¬ç«‹å¼€å‘è€…æ¥è¯´ï¼Œè¿™æ˜¯æˆæœ¬å¾ˆä½çš„æ•°æ®å­˜å‚¨æ–¹æ¡ˆï¼Œç›®å‰ä¹Ÿæ˜¯å¾ˆå¤šå¼€å‘è€…ä½¿ç”¨çš„æŠ€æœ¯æ ˆã€‚")]),t._v(" "),a("p",[t._v("Core Data æˆ‘è‡ªå·±æ„Ÿè§‰ç¨å¾®æœ‰ä¸€å®šçš„ä½¿ç”¨é—¨æ§›ï¼Œä¸è¿‡è‹¹æœè¿™å‡ å¹´ä¹Ÿåœ¨ä¸æ–­åœ°é™ä½CoreData API å’Œç›¸å…³æ¦‚å¿µçš„ä½¿ç”¨å’Œç†è§£éš¾åº¦ï¼Œè¿™éƒ¨åˆ†çš„æŠ€æœ¯å‚¨å¤‡è¿˜æ˜¯è¦è¿›è¡Œçš„ã€‚")]),t._v(" "),a("p",[t._v("æˆ‘å°è¯•ä» CoreData Stack è¿™é‡Œå¼€å§‹ç†æ¸… CoreData ç›¸å…³çš„æ¯”è¾ƒéš¾ç†è§£çš„æ¦‚å¿µã€‚äº‹å®ä¸Šä¹Ÿå°± CoreData Stack è¿™é‡Œæ¯”è¾ƒéš¾ç†è§£ã€‚")]),t._v(" "),a("h2",{attrs:{id:"coredata-stack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#coredata-stack"}},[t._v("#")]),t._v(" CoreData Stack")]),t._v(" "),a("p",[t._v("CoreData Stack å°±æ˜¯ä¸€ç»„ framework å¯¹è±¡ï¼Œè¿™ç»„å¯¹è±¡ä½œä¸º CoreData åˆå§‹åŒ–éƒ¨åˆ†ä»¥åŠç”¨äºç®¡ç†åœ¨åº”ç”¨å†…å¯¹è±¡å’Œå¤–éƒ¨æ•°æ®æºäº¤äº’ã€‚CoreData Stack è´Ÿè´£æ‰€æœ‰å’Œå¤–éƒ¨æ•°æ®æºæ‰“äº¤é“å·¥ä½œï¼Œè¿™æ ·æˆ‘ä»¬ä¸šåŠ¡æ–¹åªéœ€è¦å…³å¿ƒè‡ªå·±çš„ä¸šåŠ¡é€»è¾‘å°±å¯ä»¥äº†ã€‚CoreData Stack ä¸»è¦åŒ…å«å››ç§å¯¹è±¡")]),t._v(" "),a("ol",[a("li",[t._v("NSManagedObjectContext")]),t._v(" "),a("li",[t._v("NSPersistentStoreCoordinator,")]),t._v(" "),a("li",[t._v("NSManagedObjectModel")]),t._v(" "),a("li",[t._v("NSPersistentContainer")])]),t._v(" "),a("p",[t._v("æ¥ä¸‹æ¥ä¸€ä¸ªä¸ªè¯´ä¸‹è¿™å‡ ä¸ªå…³é”®å¯¹è±¡")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("NSManagedObjectModel ğŸ‘‰")]),t._v("Â è¿™ä¸ªÂ "),a("code",[t._v("NSManagedObjectModel")]),t._v(" å®ä¾‹æè¿°äº†è¢« CoreData Stack è®¿é—®çš„æ•°æ®ã€‚å…¶å®å°±æ˜¯ç”¨ç¨‹åºåŒ–çš„æ–¹å¼æè¿°äº†Â "),a("em",[t._v(".xcdatamodeld")]),t._v(" é‡Œçš„å¯¹è±¡ã€‚å½“å¼€å§‹åˆå§‹åŒ–Â Core Data stack çš„æ—¶å€™ï¼Œæ•°æ®åº“æ–‡ä»¶æœ€å…ˆè¢«åŠ è½½è¿›å†…å­˜å’Œ "),a("code",[t._v("NSManagedObjectModel")]),t._v(" å½¢æˆæ˜ å°„å…³ç³»ï¼Œç³»ç»Ÿå½“ç„¶çŸ¥é“è¦åŠ è½½çš„æ–‡ä»¶çš„åå­—ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("NSPersistentStoreCoordinator")]),t._v(" "),a("strong",[t._v("ğŸ‘‰")]),t._v(" Â ä½äº CoreData Stack çš„ä¸­é—´å±‚ï¼Œè´Ÿè´£å°†å®šä¹‰åœ¨ model é‡Œçš„å®ä½“å®ä¾‹åŒ–ï¼Œä¹Ÿå¯ä»¥ä»æŒä¹…åŒ–å­˜å‚¨("),a("code",[t._v("NSPersistentStore")]),t._v(")é‡Œè·å–å®ä¾‹ã€‚æ‰€ä»¥å®ƒçš„èŒè´£å°±æ˜¯æ ¹æ® Â "),a("code",[t._v("NSManagedObjectModel")]),t._v(" çš„å®šä¹‰ï¼Œä»æŒä¹…åŒ–å­˜å‚¨é‡Œå–å‡ºæˆ–è€…åˆ›é€ å®ä¾‹å¯¹è±¡ï¼Œå¹¶ä¸”å°†è¿™äº›å¯¹è±¡ä¼ ç»™Â "),a("code",[t._v("NSManagedObjectContext")]),t._v(". åŒæ—¶ä¹Ÿä¼šæ ¡éªŒæ•°æ®çš„ä¸€è‡´æ€§?(è¿™ä¸ªä¸æ˜¯å¾ˆæ˜ç™½)")]),t._v(" "),a("li",[a("strong",[t._v("NSManagedObjectContext")]),t._v(" ğŸ‘‰ è¿™ä¸ªå¯¹è±¡æ˜¯æˆ‘ä»¬åº”ç”¨è°ƒç”¨æœ€å¤šçš„ï¼Œåº”ç”¨å°±æ˜¯é€šè¿‡å®ƒä»æŒä¹…åŒ–å­˜å‚¨(persistent store)è·å–ä¸€ä»½ä¸´æ—¶çš„æ•°æ®ï¼Œç„¶ååº”ç”¨å¯ä»¥ä»»æ„æ”¹å˜è¿™ä»½æ•°æ®ï¼Œå¦‚æœä½ ä¸ä¸»åŠ¨è°ƒsaveæ–¹æ³•ï¼Œé‚£æŒä¹…åŒ–å­˜å‚¨é‡Œçš„æ•°æ®æ˜¯ä¿æŒä¸å˜çš„ã€‚æˆ‘ä»¬å°±æ˜¯é€šè¿‡è¿™ä¸ª context æ¥å¯¹æ•°æ®è¿›è¡Œå¢åˆ ç­‰æ“ä½œï¼Œè¿™ä¸ª context ä¹Ÿä¼šè¿½è¸ªæˆ‘ä»¬åšäº†å“ªäº›æ“ä½œï¼Œè¿™æ ·å®ƒå°±å¯ä»¥è¯•ä¸‹undo/redo è¿™äº›æ“ä½œäº†ã€‚è€Œå½“æˆ‘ä»¬ä¸»åŠ¨è°ƒ save æ–¹æ³•çš„æ—¶å€™ï¼Œcontext ä¼šç¡®ä¿æˆ‘ä»¬çš„æ•°æ®æ˜¯æœ‰æ•ˆçš„ï¼Œæœ‰æ•ˆçš„è¯å°±ç›´æ¥å†™å›åˆ°æŒä¹…åŒ–å­˜å‚¨é‡Œé¢ã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:s(369),alt:"CoreDataStack"}})]),t._v(" "),a("h3",{attrs:{id:"coredata-stack-åˆå§‹åŒ–"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#coredata-stack-åˆå§‹åŒ–"}},[t._v("#")]),t._v(" CoreData Stack åˆå§‹åŒ–")]),t._v(" "),a("p",[t._v("æˆ‘ä»¬åªèƒ½åœ¨åˆå§‹åŒ– CoreDataStack æ ˆä¹‹åæ‰èƒ½åœ¨åº”ç”¨ä¸­è®¿é—®å¤–éƒ¨æ•°æ®æºï¼Œä¸‹é¢è¿™å‡ è¡Œä»£ç å°±æ˜¯ CoreDataStack çš„åˆ›å»ºï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[t._v("lazy "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("persistentContainer")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" NSPersistentContainer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" container "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("NSPersistentContainer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"CoreDataDemo"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadPersistentStores")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("completionHandler"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("storeDescription"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" error "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" error "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" NSError"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("NSLog")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("@"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Failed to load Core Data stack: %@"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fatalError")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Unresolved error \\(error), \\(error.userInfo)"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" container\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("blockquote",[a("p",[t._v("loadPersistentStores(completionHandler:) API è¯´æ˜ï¼šOnce the persistent container has been initialized, you need to execute "),a("code",[t._v("loadPersistentStores(completionHandler:)")]),t._v(" to instruct the container to load the persistent stores and complete the creation of the Core Data stack. "),a("strong",[t._v("Once the completion handler has fired, the stack is fully initialized and is ready for use.")]),t._v(" The completion handler will be called once for each persistent store that is created.")])]),t._v(" "),a("p",[t._v("å¯ä»¥çœ‹åˆ°æ‰€è°“ CoreData Stack çš„åˆå§‹åŒ–å…¶å®å°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ª "),a("code",[t._v("NSPersistentContainer")]),t._v("ï¼Œç„¶åå»åŠ è½½äº†æœ¬åœ°çš„æŒä¹…åŒ–å­˜å‚¨ã€‚")]),t._v(" "),a("p",[t._v("æœ¬è´¨ä¸Š "),a("code",[t._v("NSPersistentContainer")]),t._v(" çš„ä½¿ç”¨å…¶å®æ˜¯æŠŠ CoreData Stack çš„æ¯”è¾ƒå¤æ‚çš„æµç¨‹å°è£…èµ·æ¥äº†ï¼Œå½“æˆ‘ä»¬åˆ›å»º "),a("code",[t._v("NSPersistentContainer")]),t._v(" çš„æ—¶å€™ï¼Œæœ¬è´¨ä¸Šä¹Ÿåˆ›å»ºäº† "),a("code",[t._v("NSManagedObjectModel")]),t._v("ï¼Œ"),a("code",[t._v("NSPersistentStoreCoordinator")]),t._v(" ä»¥åŠ "),a("code",[t._v("NSManagedObjectContext")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("åœ¨ iOS10 ä¹‹å‰è¿˜æœ‰ä¸€ç§æ¯”è¾ƒåŸå§‹çš„çš„ CoreData Stack åˆå§‹æ–¹å¼ï¼Œåœ¨è¿™ç§æ–¹å¼é‡Œï¼Œä½ å¯ä»¥æ¯”è¾ƒæ¸…æ¥šçš„çœ‹åˆ° CoreData Stack é‡Œçš„å¯¹è±¡æ˜¯å¦‚ä½•åä½œçš„ã€‚")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("completionClosure")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" @"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("escaping")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//1. åˆå§‹åŒ– NSManagedObjectModel.")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//2. é€šè¿‡ NSManagedObjectModel åˆå§‹åŒ– NSPersistentStoreCoordinator")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//3. é€šè¿‡ NSPersistentStoreCoordinator åˆå§‹åŒ– NSManagedContext.")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//This resource is the same name as your xcdatamodeld contained in your project")]),t._v("\n    guard "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" modelURL "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Bundle"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("forResource"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"DataModel"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("withExtension")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"momd"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fatalError")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Error loading model from bundle"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// The managed object model for the application. It is a fatal error for the application not to be able to find and load its model.")]),t._v("\n    guard "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" mom "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("NSManagedObjectModel")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("contentsOf"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" modelURL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fatalError")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Error initializing mom from: \\(modelURL)"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" psc "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("NSPersistentStoreCoordinator")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("managedObjectModel"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" mom"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    managedObjectContext "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("NSManagedObjectContext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("concurrencyType"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" NSManagedObjectContextConcurrencyType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mainQueueConcurrencyType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    managedObjectContext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("persistentStoreCoordinator "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" psc\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" queue "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" DispatchQueue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("global")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("qos"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" DispatchQoS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("QoSClass"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("background"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    queue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("async "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        guard "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" docURL "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" FileManager"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("default"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("urls")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("documentDirectory"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("userDomainMask"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("last "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fatalError")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Unable to resolve document directory"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" storeURL "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" docURL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendingPathComponent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"DataModel.sqlite"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" psc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addPersistentStore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ofType"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" NSSQLiteStoreType"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("configurationName")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" nil"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("at")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" storeURL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("options")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" nil"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//The callback block is expected to complete the User Interface and therefore should be presented back on the main queue so that the user interface does not need to be concerned with which queue this call is coming from.")]),t._v("\n            DispatchQueue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sync")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("execute"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" completionClosure"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fatalError")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Error migrating store: \\(error)"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("ä½†æ˜¯ä¸Šé¢è¿™äº›åˆ›å»ºæµç¨‹çœ‹èµ·æ¥å®åœ¨å¤æ‚ï¼Œäºæ˜¯å‡ºç°äº† "),a("code",[t._v("NSPersistentContainer")]),t._v(" æ¥ç®€åŒ– CoreData Stack çš„åˆå§‹åŒ–æµç¨‹ã€‚"),a("code",[t._v("NSPersistentContainer")]),t._v(" ä¹Ÿæä¾›äº†é…ç½®ç±» "),a("code",[t._v("NSPersistentStoreDescription")]),t._v(" æ¥ç®€åŒ– CoreData çš„é…ç½®ï¼Œæˆ‘ä»¬åœ¨åé¢ä¼šä¸æ–­çœ‹åˆ° CoreData çš„é…ç½®ã€‚")]),t._v(" "),a("p",[t._v("å‚è€ƒåœ°å€:")]),t._v(" "),a("ol",[a("li",[a("a",{attrs:{href:"https://www.notion.so/CoreData-CloudKit-ccb9e515679e4bb290d4a0d2b3602f77",target:"_blank",rel:"noopener noreferrer"}},[t._v("Core Data Programming Guide-Initializing the Core Data Stack"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.fatbobman.com/posts/masteringOfCoreDataStack/",target:"_blank",rel:"noopener noreferrer"}},[t._v("è‚˜å­çš„Swiftè®°äº‹æœ¬-æŒæ¡ Core Data Stack"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("ç›¸å…³é“¾æ¥:")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://fanthus.github.io/2022/11/08/coredata%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-1/",target:"_blank",rel:"noopener noreferrer"}},[t._v("CoreDataå­¦ä¹ ç¬”è®° 1"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://fanthus.github.io/2022/11/24/coredata%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-2/",target:"_blank",rel:"noopener noreferrer"}},[t._v("CoreDataå­¦ä¹ ç¬”è®° 2"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://fanthus.github.io/2022/11/24/coredata%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-3/",target:"_blank",rel:"noopener noreferrer"}},[t._v("CoreDataå­¦ä¹ ç¬”è®° 3"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://fanthus.github.io/2022/11/25/coredata%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-4/",target:"_blank",rel:"noopener noreferrer"}},[t._v("CoreDataå­¦ä¹ ç¬”è®° 4"),a("OutboundLink")],1)])]),t._v(" "),a("Vssue",{attrs:{title:t.CoreDataå­¦ä¹ ç¬”è®°_1}})],1)}),[],!1,null,null,null);a.default=n.exports}}]);